<%- include('../templeteAdmin/sidebar') %>


<body>  
    
    <div class="content">       
        <h1>Product Member</h1>
        <a href='/products/formcreate' class="btn btn-primary">Create</a>
        <br>
        <table class="data-table">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Product</th>
                    <th>Duration</th>
                    <th>Price</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                    <% products.forEach((products, index) => { %>
                    <tr>
                    <th scope="row"><%= index + 1 %></th>
                    <td><%= products.name_product %></td>
                    <td><%= products.duration %></td>
                    <td><%= products.price %></td>
                    <td>
                        <a href="/products/one/<%= products.id %>" type="button" class="btn btn-primary" >Edit</a>
                        <!-- <a class="btn btn-danger" href="/products/delete<%= products.id %>" onclick="return confirm('Are you sure you want to delete this product?')">Delete</a> -->
                        <a href="#" class="btn btn-icon btn-danger" onclick="deleteRoom('<%= products.id %>')">
                           Delete
                        </a>
                    </td>
                  </tr>
                <% }); %>
                </tbody>
        </table>
    </div>
<script>
    function deleteRoom(productId) {
        if (confirm("Are you sure you want to delete this products?")) {
            fetch(`/products/delete/${productId}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json',
                    // You may need to include additional headers depending on your server requirements
                },
                // You can include a request body if needed
                // body: JSON.stringify({ roomId: roomId }),
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }else{
                    window.location.href = '/products'
                }
                // You can handle success here, e.g., redirect to a different page
                // window.location.href = '/success-page';
            })
            .catch(error => {
                console.error('Error:', error);
                // Handle the error as needed
            });
        }
    }
</script>
</body>



